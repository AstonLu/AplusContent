<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ASUS Business Product Spec Search</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; background: #f4f6f8; margin:0; padding:2rem; color:#333; }
    .container { max-width:800px; margin:0 auto; }
    .header { text-align: center; }
    .logo { max-width:200px; margin:0 auto 1rem; display:block; }
    h1 { margin:0 0 .5rem; font-size:2rem; text-transform:uppercase; }
    .subtitle { margin:0 0 1.5rem; font-size:.875rem; color:#666; }
    .search-container { position:relative; max-width:600px; margin:0 auto 1rem; }
    #search { width:100%; padding:.75rem 1rem; font-size:1rem; border:1px solid #ccc; border-radius:4px; }
    #clearBtn { position:absolute; right:.5rem; top:50%; transform:translateY(-50%); background:none; border:none; font-size:1.25rem; color:#888; cursor:pointer; display:none; }
    #clearBtn:hover { color:#555; }
    .history { text-align:center; font-size:.875rem; color:#555; margin:.5rem 0; }
    .history span { background:#e1e1e1; padding:.25rem .5rem; margin:.125rem; border-radius:4px; cursor:pointer; }
    .history span:hover { background:#ccc; }
    .message { text-align:center; color:#777; margin:1rem 0; font-style:italic; }
    .section { background:#fff; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); padding:1rem; margin-top:1rem; }
    .section h2 { margin:0 0 1rem; font-size:1.25rem; }
    .spec { display:grid; grid-template-columns:150px 1fr; align-items:start; padding:.75rem 1rem; border-bottom:1px solid #eee; }
    .spec:last-child { border-bottom:none; }
    .spec-label { font-weight:600; color:#555; user-select:none; padding-right:1rem; }
    .spec-value { user-select:text; color:#333; white-space:pre-wrap; word-break:break-word; }
    .link-content p { margin:0 0 .5rem; color:#555; font-size:.875rem; }
    .link-content a { display:inline-block; background:#0072c6; color:#fff; text-decoration:none; font-weight:600; padding:.5rem 1rem; border-radius:4px; transition:background 0.2s; }
    .link-content a:hover { background:#005fa3; }
    .tutor-box img { width:100%; height:auto; cursor:zoom-in; display:block; border-radius:4px; }
    .modal { display:none; position:fixed; z-index:1000; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); align-items:center; justify-content:center; }
    .modal img { max-width:90%; max-height:90%; border-radius:4px; }
    .modal-close { position:absolute; top:1rem; right:1rem; font-size:2rem; color:#fff; cursor:pointer; }
    .retryBtn { display:block; margin:1.5rem auto 0; padding:.5rem 1rem; border:none; border-radius:4px; background:#0072c6; color:#fff; cursor:pointer; }
    .retryBtn:hover { background:#005fa3; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="asus-logo.png" class="logo" alt="ASUS Business Logo">
      <h1>ASUS Business Product Spec Search</h1>
      <p class="subtitle">Copyright ¬© ASUS Indonesia Commercial Department</p>
    </div>
    <div class="search-container">
      <input id="search" placeholder="e.g. B1402CVA-NK7110X">
      <button id="clearBtn">√ó</button>
    </div>
    <div class="history" id="history"></div>
    <div class="message" id="message">Type a name to search (e.g. B1402CVA-NK7110X)</div>

    <div id="results-wrapper" style="display:none;">
      <div class="section" id="spec-section">
        <h2>SPEC</h2>
        <div id="card"></div>
      </div>
      <div class="section" id="materials-section">
        <h2>MATERIALS</h2>
        <div class="link-content" id="link-content">
          <p>ÈªûÊìä‰∏ãÊñπÊåâÈàï‰∏ãËºâÊàñÊü•ÁúãÁõ∏ÈóúÁ¥†Êùê„ÄÇ</p>
        </div>
        <div class="tutor-box" style="margin-top:1rem;"><img id="tutor-img" src="tutor.jpg" alt="Tutor"></div>
      </div>
    </div>

    <button class="retryBtn" id="retryBtn" style="display:none;">üîç Search Again</button>
  </div>

  <div id="modal" class="modal">
    <span id="modal-close" class="modal-close">&times;</span>
    <img id="modal-img" src="">
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script>
    let data = [];
    const searchInput = document.getElementById('search');
    const clearBtn = document.getElementById('clearBtn');
    const retryBtn = document.getElementById('retryBtn');
    const historyEl = document.getElementById('history');
    const messageEl = document.getElementById('message');
    const resultsWrapper = document.getElementById('results-wrapper');
    const cardDiv = document.getElementById('card');
    const linkContent = document.getElementById('link-content');
    const tutorImg = document.getElementById('tutor-img');
    const modal = document.getElementById('modal');
    const modalImg = document.getElementById('modal-img');
    const modalClose = document.getElementById('modal-close');

    function renderMatch(row) {
      // ÊåâÊåáÂÆöÈ†ÜÂ∫èÈ°ØÁ§∫Ê¨Ñ‰Ωç
      const order = [
        'Product Name','Marketing name','Tagline','KSP','Title','CPU','GPU','OS',
        'Panel Size','Resolution','Brightness','RAM','SSD','IO Port',
        'Weight (with Battery)','Size','Expansion Slot','Include in the box',
        'Battery','Power Supply','Security'
      ];
      cardDiv.innerHTML = '';
      order.forEach(key => {
        const val = row[key];
        const spec = document.createElement('div');
        spec.className = 'spec' + (['KSP','Security'].includes(key) ? ' multiline' : '');
        const label = document.createElement('div'); label.className = 'spec-label'; label.textContent = key;
        const value = document.createElement('div'); value.className = 'spec-value';
        if (['KSP','Security'].includes(key)) {
          (val || '').split(/\r?\n/).forEach(line => {
            const d = document.createElement('div'); d.textContent = line || '-'; value.append(d);
          });
        } else {
          value.textContent = val || '-';
        }
        spec.append(label, value);
        cardDiv.append(spec);
      });
      // Link ÂçÄÂ°ä
      linkContent.innerHTML = '';
      const url = row['Link'];
      if (url) {
        const btn = document.createElement('a');
        btn.href = url; btn.target = '_blank'; btn.textContent = 'Visit Link';
        linkContent.append(btn);
      } else {
        linkContent.textContent = 'Coming Soon';
      }
      // È°ØÁ§∫ÁµêÊûú
      messageEl.style.display = 'none';
      resultsWrapper.style.display = 'block';
      clearBtn.style.display = 'block';
      retryBtn.style.display = 'block';
    }

    function reset() {
      searchInput.value = '';
      messageEl.textContent = 'Type a name to search (e.g. B1402CVA-NK7110X)';
      messageEl.style.display = '';
      resultsWrapper.style.display = 'none';
      clearBtn.style.display = 'none';
      retryBtn.style.display = 'none';
      searchInput.focus();
    }

    // ËºâÂÖ• CSV ÂæåÁ∂ÅÂÆö‰∫ã‰ª∂
    searchInput.disabled = true;
    messageEl.textContent = 'Loading data, please wait...';
    Papa.parse('data.csv', {
      download: true, header: true, skipEmptyLines: true,
      complete: (results) => {
        data = results.data;
        searchInput.disabled = false;
        messageEl.textContent = 'Type a name to search (e.g. B1402CVA-NK7110X)';
        // Á∂ÅÂÆöÊêúÂ∞ã
        searchInput.addEventListener('input', () => {
          const term = searchInput.value.trim().toLowerCase();
          clearBtn.style.display = term ? 'block' : 'none';
          if (!term) { reset(); return; }
          const row = data.find(r => (r['Product Name'] || '').toLowerCase().includes(term));
          if (row) renderMatch(row);
          else {
            messageEl.textContent = 'No product found';
            messageEl.style.display = '';
            resultsWrapper.style.display = 'none';
            clearBtn.style.display = 'block';
            retryBtn.style.display = 'block';
          }
        });
      }
    });

    clearBtn.addEventListener('click', reset);
    retryBtn.addEventListener('click', reset);

    // Tutor ÂúñÊîæÂ§ß
    tutorImg.addEventListener('click', () => {
      modalImg.src = tutorImg.src;
      modal.style.display = 'flex';
    });
    modalClose.addEventListener('click', () => { modal.style.display = 'none'; });
    modal.addEventListener('click', e => { if (e.target === modal) modal.style.display = 'none'; });

    searchInput.focus();
  </script>
</body>
</html>
